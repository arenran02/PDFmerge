<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ë¡œì»¬ PDF íˆ´</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- pdf-lib (ì´ë¯¸ì§€ â†’ PDF, PDF ë³‘í•©ìš©) -->
  <script src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>
  <!-- PDF.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.min.js"></script>
  <style>
    /* ê¸°ì¡´ ìŠ¤íƒ€ì¼ */
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f4f4f5;
      color: #111827;
      display: flex;
      justify-content: center;
      padding: 32px 16px;
    }
    .app {
      width: 100%;
      max-width: 900px;
      background: #ffffff;
      border-radius: 18px;
      box-shadow: 0 18px 40px rgba(15, 23, 42, 0.15);
      padding: 24px;
    }
    h1 {
      margin-top: 0;
      font-size: 24px;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .mode-switch {
      display: flex;
      gap: 8px;
      margin: 16px 0 20px;
    }
    .mode-option {
      flex: 1;
      border-radius: 999px;
      border: 1px solid #e5e7eb;
      padding: 8px 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      cursor: pointer;
      font-size: 14px;
      transition: background 0.15s, border-color 0.15s, color 0.15s, transform 0.05s ease-out;
    }
    .mode-option input { display: none; }
    .mode-option.active {
      background: #111827;
      color: #f9fafb;
      border-color: #111827;
      transform: translateY(-1px);
    }
    .drop-zone {
      border-radius: 16px;
      border: 1.8px dashed #d1d5db;
      padding: 24px;
      text-align: center;
      background: #f9fafb;
      display: flex;
      flex-direction: column;
      gap: 12px;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: border-color 0.15s, background 0.15s, transform 0.05s ease-out;
    }
    /* í¸ì§‘ ê¸°ëŠ¥ ì¶”ê°€ ìŠ¤íƒ€ì¼ */
    .editor-container {
      margin-top: 20px;
    }
    .editor-btn {
      padding: 10px;
      background: #111827;
      color: #f9fafb;
      border: none;
      border-radius: 999px;
      cursor: pointer;
      margin-right: 10px;
    }
    .editor-btn:disabled {
      background: #ccc;
      cursor: not-allowed;
    }
    .pdf-container {
      margin-top: 20px;
      display: flex;
      justify-content: center;
      overflow: hidden;
    }
    .pdf-canvas {
      border: 1px solid #ddd;
    }
  </style>
</head>
<body>
  <div class="app">
    <h1>
      <span class="logo">P</span>
      ë¡œì»¬ PDF ë„êµ¬
    </h1>

    <div class="mode-switch" id="mode-switch">
      <label class="mode-option active" data-mode="images">
        <input type="radio" name="mode" value="images" checked />
        <span>ì´ë¯¸ì§€ â†’ PDF</span>
      </label>
      <label class="mode-option" data-mode="merge">
        <input type="radio" name="mode" value="merge" />
        <span>PDF í•©ì¹˜ê¸°</span>
      </label>
      <label class="mode-option" data-mode="edit">
        <input type="radio" name="mode" value="edit" />
        <span>PDF í¸ì§‘</span>
      </label>
    </div>

    <div class="hint" id="mode-hint">
      PNG / JPG ì—¬ëŸ¬ ê°œë¥¼ ì˜¬ë ¤ì„œ í•˜ë‚˜ì˜ PDFë¡œ ë§Œë“¤ ìˆ˜ ìˆì–´ìš”.
    </div>

    <!-- ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì˜ì—­ -->
    <div class="drop-zone" id="drop-zone">
      <div class="drop-title" id="drop-title">
        ì—¬ê¸°ì— íŒŒì¼ì„ ë“œë˜ê·¸í•´ì„œ ì˜¬ë ¤ì£¼ì„¸ìš”
      </div>
      <div class="drop-sub" id="drop-sub">
        ë˜ëŠ”
      </div>
      <button class="browse-btn" id="browse-btn" type="button">
        <span>ğŸ“</span> íŒŒì¼ ì„ íƒí•˜ê¸°
      </button>
      <input type="file" id="file-input" multiple />
    </div>

    <div class="editor-container" id="editor-container" style="display: none;">
      <button class="editor-btn" id="delete-btn" disabled>í˜ì´ì§€ ì‚­ì œ</button>
      <button class="editor-btn" id="insert-btn" disabled>í˜ì´ì§€ ì‚½ì…</button>
    </div>

    <div class="pdf-container" id="pdf-container" style="display: none;">
      <canvas id="pdf-canvas" class="pdf-canvas"></canvas>
    </div>
  </div>

  <script>
    const dropZone = document.getElementById("drop-zone");
    const fileInput = document.getElementById("file-input");
    const modeSwitch = document.getElementById("mode-switch");
    const editorContainer = document.getElementById("editor-container");
    const deleteBtn = document.getElementById("delete-btn");
    const insertBtn = document.getElementById("insert-btn");
    const pdfCanvas = document.getElementById("pdf-canvas");
    let mode = "images"; // ê¸°ë³¸ ëª¨ë“œ
    let pdfDoc = null;
    let currentPage = 1;
    let totalPages = 0;

    function updateModeUI() {
      const options = modeSwitch.querySelectorAll(".mode-option");
      options.forEach((opt) => {
        if (opt.dataset.mode === mode) opt.classList.add("active");
        else opt.classList.remove("active");
      });

      if (mode === "edit") {
        editorContainer.style.display = "block";
      } else {
        editorContainer.style.display = "none";
      }

      renderFileList();
    }

    modeSwitch.addEventListener("click", (e) => {
      const label = e.target.closest(".mode-option");
      if (!label) return;
      const newMode = label.dataset.mode;
      if (newMode && newMode !== mode) {
        mode = newMode;
        updateModeUI();
      }
    });

    fileInput.addEventListener("change", (e) => {
      if (!e.target.files) return;
      handleFiles(e.target.files);
      fileInput.value = "";
    });

    dropZone.addEventListener("drop", (e) => {
      const dt = e.dataTransfer;
      if (!dt || !dt.files) return;
      handleFiles(dt.files);
    });

    function handleFiles(fileList) {
      const file = fileList[0]; // ì²« ë²ˆì§¸ íŒŒì¼ë§Œ ì²˜ë¦¬
      if (file.type === "application/pdf") {
        loadPdf(file);
      } else {
        alert("PDF íŒŒì¼ë§Œ ì§€ì›ë©ë‹ˆë‹¤.");
      }
    }

    function loadPdf(file) {
      const reader = new FileReader();
      reader.onload = async (e) => {
        const pdfData = new Uint8Array(e.target.result);
        pdfDoc = await pdfjsLib.getDocument(pdfData).promise;
        totalPages = pdfDoc.numPages;
        currentPage = 1;
        renderPdfPage(currentPage);
      };
      reader.readAsArrayBuffer(file);
    }

    function renderPdfPage(pageNum) {
      pdfDoc.getPage(pageNum).then((page) => {
        const viewport = page.getViewport({ scale: 1.5 });
        pdfCanvas.height = viewport.height;
        pdfCanvas.width = viewport.width;

        const context = pdfCanvas.getContext("2d");
        const renderContext = {
          canvasContext: context,
          viewport: viewport
        };
        page.render(renderContext);

        deleteBtn.disabled = currentPage === 1;
        insertBtn.disabled = currentPage === totalPages;
      });
    }

    deleteBtn.addEventListener("click", () => {
      if (pdfDoc) {
        // í˜ì´ì§€ ì‚­ì œ ì²˜ë¦¬
        alert("í˜ì´ì§€ ì‚­ì œ ê¸°ëŠ¥ì€ PDF-libë¥¼ í™œìš©í•˜ì—¬ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
      }
    });

    insertBtn.addEventListener("click", () => {
      if (pdfDoc) {
        // í˜ì´ì§€ ì‚½ì… ì²˜ë¦¬
        alert("í˜ì´ì§€ ì‚½ì… ê¸°ëŠ¥ì€ PDF-libë¥¼ í™œìš©í•˜ì—¬ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
      }
    });

    updateModeUI();
  </script>
</body>
</html>
